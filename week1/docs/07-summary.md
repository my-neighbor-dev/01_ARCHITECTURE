# 7. μ •λ¦¬ λ° Q&A

## 7.1 μ¤λ λ°°μ΄ λ‚΄μ© μ •λ¦¬

### 1. Serviceλ” κΈ°μ μ— μμ΅΄ν•μ§€ μ•μ•„μ•Ό ν•λ‹¤

**λ¬Έμ **: Serviceκ°€ JPA Entityλ‚ Feign Clientλ¥Ό μ§μ ‘ μ‚¬μ©ν•λ©΄ κΈ°μ μ— μμ΅΄ν•κ² λ¨

**ν•΄κ²°**: 
- Repository μΈν„°νμ΄μ¤ μ‚¬μ©
- μ™Έλ¶€ API μΈν„°νμ΄μ¤ μ‚¬μ©
- Serviceλ” μΈν„°νμ΄μ¤λ§ μ°Έμ΅°

**κ²°κ³Ό**: Serviceκ°€ λΉ„μ¦λ‹μ¤ λ΅μ§μ—λ§ μ§‘μ¤‘ν•  μ μμ

### 2. Repository μΈν„°νμ΄μ¤ν™”

**λ¬Έμ **: κΈ°μ  μ¤νƒμ„ λ°”κΎΈλ ¤λ©΄ Service μ½”λ“λ¥Ό μμ •ν•΄μ•Ό ν•¨

**ν•΄κ²°**: Repository μΈν„°νμ΄μ¤λ΅ λ¶„λ¦¬

**κ²°κ³Ό**: κΈ°μ  μ¤νƒμ„ μ μ—°ν•κ² κµμ²΄ κ°€λ¥ (JPA β†’ JDBC λ“±)

### 3. Orchestrator ν¨ν„΄

**λ¬Έμ **: Serviceκ°€ λ±λ±ν•΄μ Έμ„ λ¨λ“  μ±…μ„μ΄ ν• κ³³μ— λ¨μ„

**ν•΄κ²°**: 
- Serviceλ” λΉ„μ¦λ‹μ¤ λ΅μ§λ§ λ‹΄λ‹Ή
- Orchestratorλ” μ—¬λ¬ Serviceλ¥Ό μ΅°μ¨ν•μ—¬ DTO μ΅°λ¦½

**κ²°κ³Ό**: μ¬μ‚¬μ© κ°€λ¥ν• κµ¬μ΅°

### 4. API μΈν„°νμ΄μ¤ κ³„μΈµ

**λ¬Έμ **: API μ¤ν™μ΄ μ½”λ“μ— λ…ν™•ν•κ² μ •μλμ§€ μ•μ

**ν•΄κ²°**: API μΈν„°νμ΄μ¤μ— Swagger μ–΄λ…Έν…μ΄μ… μ¶”κ°€

**κ²°κ³Ό**: λ‹¤λ¥Έ μ„λΉ„μ¤μ—μ„ API μΈν„°νμ΄μ¤λ§ κ³µμ ν•λ©΄ API μ¤ν™μ„ μ• μ μμ

### 5. μ™Έλ¶€ API νΈμ¶: Feign ν¨ν„΄

**λ¬Έμ **: Serviceκ°€ Feign Clientλ¥Ό μ§μ ‘ μ‚¬μ©ν•λ©΄ κΈ°μ μ— μμ΅΄ν•κ² λ¨

**ν•΄κ²°**: 
- μ™Έλ¶€ API μΈν„°νμ΄μ¤ μƒμ„± (auth-external-api)
- Feign κµ¬ν„μ²΄ μƒμ„± (auth-external-api-using-feign)
- Serviceλ” μΈν„°νμ΄μ¤λ§ μ°Έμ΅° (Feign κµ¬ν„μ²΄ μ§μ ‘ μ°Έμ΅° μ• ν•¨)

**κ²°κ³Ό**: Serviceκ°€ κΈ°μ μ— μμ΅΄ν•μ§€ μ•μ, λ¨λ“ κ°„ μ•½ν• κ²°ν•©

---

## 7.2 ν•µμ‹¬ μ›μΉ™

### μ›μΉ™ 1: Serviceλ” κΈ°μ μ— μμ΅΄ν•μ§€ μ•μ•„μ•Ό ν•λ‹¤

```
Service β†’ Repository (μΈν„°νμ΄μ¤)  β† κΈ°μ  λ…λ¦½μ 
Service β†’ AuthUserApi (μΈν„°νμ΄μ¤)  β† κΈ°μ  λ…λ¦½μ 
```

**ν•µμ‹¬**: Serviceλ” λΉ„μ¦λ‹μ¤ λ΅μ§λ§ λ‹΄λ‹Ήν•κ³ , κΈ°μ μ μΈ λ¶€λ¶„μ€ μΈν„°νμ΄μ¤λ¥Ό ν†µν•΄ λ¶„λ¦¬

### μ›μΉ™ 2: Repository μΈν„°νμ΄μ¤ν™”

```
user-repository/          β† μΈν„°νμ΄μ¤
user-repository-using-jpa/  β† κµ¬ν„μ²΄
```

### μ›μΉ™ 3: Serviceλ” λΉ„μ¦λ‹μ¤ λ΅μ§λ§ λ‹΄λ‹Ή

```java
AuthService: μ μ € μ΅°ν, λΉ„λ°€λ²νΈ κ²€μ¦, ν† ν° μƒμ„±
CookieService: μΏ ν‚¤ μƒμ„±
```


### μ›μΉ™ 4: Orchestratorλ” DTO μ΅°λ¦½λ§ λ‹΄λ‹Ή

```java
AuthOrchestrator {
    - AuthService νΈμ¶ (λΉ„μ¦λ‹μ¤ λ΅μ§)
    - CookieService νΈμ¶
    - DTO μ΅°λ¦½
}
```

### μ›μΉ™ 5: μ™Έλ¶€ λ¨λ“ νΈμ¶μ€ μΈν„°νμ΄μ¤ + Feign

```java
// Serviceλ” μΈν„°νμ΄μ¤λ§ μ°Έμ΅°
AuthService β†’ AuthUserApi (μΈν„°νμ΄μ¤) β†’ AuthUserApiFeign (Feign κµ¬ν„μ²΄)
```

**ν•µμ‹¬**: Serviceλ” κΈ°μ μ— μμ΅΄ν•μ§€ μ•λ„λ΅ μΈν„°νμ΄μ¤λ§ μ°Έμ΅°

### μ›μΉ™ 6: Entityμ™€ λ„λ©”μΈ λ¨λΈ λ¶„λ¦¬

```
user-domain/              β† User (λ„λ©”μΈ λ¨λΈ, κΈ°μ  λ…λ¦½μ )
user-repository-using-jpa/  β† UserEntity (Entity, JPA μμ΅΄μ )
```

```java
// User.java (λ„λ©”μΈ λ¨λΈ, κΈ°μ  λ…λ¦½μ )
public class User {
    private Long id;
    private String email;
    // ...
}

// UserEntity.java (Entity, JPA μμ΅΄μ )
@Entity
@Table(name = "users")
public class UserEntity {
    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long id;
    // ...
}

// Repository κµ¬ν„μ²΄μ—μ„ λ³€ν™
public User findById(Long id) {
    UserEntity entity = userJpaRepository.findById(id);
    return convertToUser(entity);  // Entity β†’ Domain
}
```

### μ›μΉ™ 7: API μΈν„°νμ΄μ¤λ΅ μ¤ν™ μ •μ

```java
// API μΈν„°νμ΄μ¤
public interface UserApi {
    @Operation(summary = "μ μ € μ •λ³΄ μ΅°ν")
    UserResponse getUserById(@PathVariable Long id);
}

// Controllerκ°€ κµ¬ν„
@RestController
public class UserController implements UserApi {
    // ...
}
```

---

## 7.3 Before vs After λΉ„κµ

### Before

```
β κΈ°μ  μ¤νƒ κµμ²΄ μ–΄λ ¤μ›€
β λ±λ±ν• Service (λ¨λ“  μ±…μ„ ν¬ν•¨)
β Entityλ¥Ό λ„λ©”μΈ λ¨λΈλ΅ μ‚¬μ© (JPA μμ΅΄μ )
β μ™Έλ¶€ λ¨λ“ μ§μ ‘ μ°Έμ΅°
β μ¬μ‚¬μ© μ–΄λ ¤μ›€
```

### After

```
β… κΈ°μ  μ¤νƒ μ μ—°ν•κ² κµμ²΄ κ°€λ¥
β… Serviceλ” λΉ„μ¦λ‹μ¤ λ΅μ§λ§, Orchestratorλ” DTO μ΅°λ¦½λ§
β… μ™Έλ¶€ λ¨λ“ νΈμ¶μ€ μΈν„°νμ΄μ¤ + Feign
β… λ„λ©”μΈ λ¨λΈμ€ domain λ¨λ“μ— λ¶„λ¦¬
β… μ¬μ‚¬μ© μ©μ΄
```

---

## 7.4 μ‹¤λ¬΄ μ μ© μ²΄ν¬λ¦¬μ¤νΈ

### Repository μΈν„°νμ΄μ¤ν™”

- [ ] Repository μΈν„°νμ΄μ¤λ¥Ό repository λ¨λ“μ— μƒμ„±ν–λ”κ°€?
- [ ] κµ¬ν„μ²΄λ¥Ό λ³„λ„ λ¨λ“μ— μƒμ„±ν–λ”κ°€?
- [ ] Serviceκ°€ Repository μΈν„°νμ΄μ¤λ§ μ°Έμ΅°ν•λ”κ°€?

### Orchestrator ν¨ν„΄

- [ ] Serviceλ” λΉ„μ¦λ‹μ¤ λ΅μ§λ§ λ‹΄λ‹Ήν•λ”κ°€?
- [ ] Orchestratorλ” DTO μ΅°λ¦½λ§ λ‹΄λ‹Ήν•λ”κ°€?
- [ ] Controllerλ” Orchestratorλ§ νΈμ¶ν•λ”κ°€?

### API μΈν„°νμ΄μ¤ κ³„μΈµ

- [ ] API μΈν„°νμ΄μ¤μ— Swagger μ–΄λ…Έν…μ΄μ…μ΄ μλ”κ°€?
- [ ] Controllerκ°€ API μΈν„°νμ΄μ¤λ¥Ό κµ¬ν„ν•λ”κ°€?


### μ™Έλ¶€ API νΈμ¶

- [ ] μ™Έλ¶€ API μΈν„°νμ΄μ¤λ¥Ό λ³„λ„ λ¨λ“μ— μƒμ„±ν–λ”κ°€?
- [ ] μ™Έλ¶€ Api μ°Έμ΅°κ°€ ν•„μ”ν•  λ• μ™Έλ¶€ API μΈν„°νμ΄μ¤λ§ μ°Έμ΅°ν•λ”κ°€?


### Entityμ™€ λ„λ©”μΈ λ¨λΈ λ¶„λ¦¬

- [ ] λ„λ©”μΈ λ¨λΈμ€ domain λ¨λ“μ— μ„μΉν•λ”κ°€? (κΈ°μ  λ…λ¦½μ )
- [ ] Entityλ” Repository κµ¬ν„μ²΄μ—λ§ μ„μΉν•λ”κ°€? (JPA μμ΅΄μ )
- [ ] Repository κµ¬ν„μ²΄μ—μ„ Entity β†’ Domain λ³€ν™ν•λ”κ°€?

---

## 7.5 μμ£Ό λ¬»λ” μ§λ¬Έ (FAQ)

### Q1: Serviceκ°€ κΈ°μ μ— μμ΅΄ν•λ©΄ μ• λλ‚μ”?

**A**: **λ„¤, Serviceλ” κΈ°μ μ— μμ΅΄ν•λ©΄ μ• λ©λ‹λ‹¤.**
- Serviceλ” Repository μΈν„°νμ΄μ¤λ§ μ°Έμ΅° (κµ¬ν„μ²΄ μ§μ ‘ μ°Έμ΅° μ• ν•¨)
- Serviceλ” μ™Έλ¶€ API μΈν„°νμ΄μ¤λ§ μ°Έμ΅° (Feign κµ¬ν„μ²΄ μ§μ ‘ μ°Έμ΅° μ• ν•¨)
- κΈ°μ μ μΈ λ¶€λ¶„μ€ Repository κµ¬ν„μ²΄λ‚ Feign κµ¬ν„μ²΄μ—λ§ μ΅΄μ¬

### Q2: Serviceκ°€ κΈ°μ μ— μμ΅΄ν•μ§€ μ•μΌλ ¤λ©΄ μ–΄λ–»κ² ν•΄μ•Ό ν•λ‚μ”?

**A**:
- **Repository**: ν•­μƒ μΈν„°νμ΄μ¤ μ‚¬μ© (Serviceλ” κµ¬ν„μ²΄ μ§μ ‘ μ°Έμ΅° μ• ν•¨)
- **μ™Έλ¶€ API νΈμ¶**: μΈν„°νμ΄μ¤ μ‚¬μ© (Serviceλ” Feign κµ¬ν„μ²΄ μ§μ ‘ μ°Έμ΅° μ• ν•¨)
- **λ„λ©”μΈ λ¨λΈ**: κΈ°μ  λ…λ¦½μ μΈ λ„λ©”μΈ λ¨λΈ μ‚¬μ© (Entity μ§μ ‘ μ‚¬μ© μ• ν•¨)

**ν•µμ‹¬**: Serviceλ” μΈν„°νμ΄μ¤λ§ μ°Έμ΅°ν•κ³ , κΈ°μ μ μΈ λ¶€λ¶„μ€ κµ¬ν„μ²΄μ—λ§ μ΅΄μ¬ν•©λ‹λ‹¤.


**μ΄μ **: Serviceκ°€ λΉ„μ¦λ‹μ¤ λ΅μ§μ—λ§ μ§‘μ¤‘ν•  μ μλ„λ΅ ν•κΈ° μ„ν•΄μ„μ…λ‹λ‹¤.

### Q3: Orchestratorλ„ μΈν„°νμ΄μ¤λ΅ λ§λ“¤μ–΄μ•Ό ν•λ‚μ”?

**A**: μΌλ°μ μΌλ΅λ” ν•„μ” μ—†μµλ‹λ‹¤.
- Orchestratorλ” API κ³„μΈµμ μΌλ¶€μ΄λ―€λ΅ λ‹¤λ¥Έ λ¨λ“μ—μ„ μ°Έμ΅°ν•μ§€ μ•μµλ‹λ‹¤.
- Controllerμ—μ„λ§ μ‚¬μ©ν•λ―€λ΅ μΈν„°νμ΄μ¤ μ—†μ΄ κµ¬ν„μ²΄λ§ μ‚¬μ©ν•©λ‹λ‹¤.

### Q4: Repository κµ¬ν„μ²΄λ¥Ό μ—¬λ¬ κ° λ§λ“¤ μ μλ‚μ”?

**A**: λ„¤, κ°€λ¥ν•©λ‹λ‹¤.
- JPA κµ¬ν„μ²΄, JDBC κµ¬ν„μ²΄, MyBatis κµ¬ν„μ²΄ λ“± μ—¬λ¬ κ° λ§λ“¤ μ μμµλ‹λ‹¤.
- ν•μ§€λ§ λ™μ‹μ— ν•λ‚λ§ ν™μ„±ν™”ν•΄μ•Ό ν•©λ‹λ‹¤.

### Q5: Serviceμ™€ Orchestratorμ μ°¨μ΄λ”?

**A**: 
- **Service**: λΉ„μ¦λ‹μ¤ λ΅μ§ μ²λ¦¬ (μ: μ μ € μ΅°ν, λΉ„λ°€λ²νΈ κ²€μ¦, ν† ν° μƒμ„±)
- **Orchestrator**: μ—¬λ¬ Serviceλ¥Ό μ΅°μ¨ν•μ—¬ DTO μ΅°λ¦½ (μ: LoginResult β†’ LoginResponse)

### Q6: API μΈν„°νμ΄μ¤λ” μ™ ν•„μ”ν•κ°€μ”?

**A**: 
- API μ¤ν™μ„ μ½”λ“λ΅ λ…ν™•ν•κ² μ •μν•κΈ° μ„ν•΄
- λ‹¤λ¥Έ μ„λΉ„μ¤μ—μ„ API μΈν„°νμ΄μ¤λ§ κ³µμ ν•λ©΄ API μ¤ν™μ„ μ• μ μκΈ° μ„ν•΄
- Swagger λ¬Έμ„ μλ™ μƒμ„± λ° νƒ€μ… μ•μ •μ„±μ„ μ„ν•΄

### Q7: Entityμ™€ λ„λ©”μΈ λ¨λΈμ μ°¨μ΄λ”?

**A**:
- **λ„λ©”μΈ λ¨λΈ**: λΉ„μ¦λ‹μ¤ λ΅μ§μ—μ„ μ‚¬μ©ν•λ” κ°μ²΄ (domain λ¨λ“, κΈ°μ  λ…λ¦½μ )
- **Entity**: JPAμ—μ„ μ‚¬μ©ν•λ” κ°μ²΄ (Repository κµ¬ν„μ²΄, JPA μμ΅΄μ )
- Entityλ” JPA μ–΄λ…Έν…μ΄μ…(`@Entity`, `@Table` λ“±)μ— μμ΅΄ν•λ―€λ΅ λ„λ©”μΈ λ¨λΈκ³Ό λ¶„λ¦¬ν•΄μ•Ό ν•©λ‹λ‹¤
- Repository κµ¬ν„μ²΄μ—μ„ Entity β†’ Domain λ³€ν™μ„ μν–‰ν•©λ‹λ‹¤


---

## 7.6 λ‹¤μ λ‹¨κ³„

### μ‹¤μµ κ³Όμ 

ν•„μλ” μ•„λ‹μ§€λ§ κ°μΈ ν”„λ΅μ νΈμ— ν•λ² μ μ©ν•΄λ³΄μ‹λ” κ±Έ μ¶”μ²ν•©λ‹λ‹¤! μ μ©ν•μ‹  λ¶„μ€ λ‹¤μμ£Όμ— κ°„λ‹¨ν•κ² κ³µμ λ„ λ¶€νƒλ“λ ¤μ”

1. **κΈ°μ΅΄ ν”„λ΅μ νΈμ— μ μ©ν•΄λ³΄κΈ°**
   - Repository μΈν„°νμ΄μ¤ μƒμ„±
   - Orchestrator ν¨ν„΄ μ μ©
   - μ™Έλ¶€ API νΈμ¶ μ‹ Feign ν¨ν„΄ μ μ©
   - Entityμ™€ λ„λ©”μΈ λ¨λΈ λ¶„λ¦¬

2. **Before/After λΉ„κµ**
   - κΈ°μ΅΄ μ½”λ“μ™€ κ°μ„ λ μ½”λ“ λΉ„κµ
   - μ–΄λ–¤ μ μ΄ κ°μ„ λμ—λ”μ§€ μ •λ¦¬

3. **μ΄λ ¥μ„μ— μ‘μ„±ν•κΈ°**
   - "Serviceλ” λΉ„μ¦λ‹μ¤ λ΅μ§λ§ λ‹΄λ‹Ήν•κ³  κΈ°μ μ— μμ΅΄ν•μ§€ μ•λ„λ΅ μ„¤κ³„"
   - "Repository μΈν„°νμ΄μ¤ν™”λ¥Ό ν†µν• κΈ°μ  μ¤νƒ μ μ—°μ„± ν™•λ³΄"
   - "Orchestrator ν¨ν„΄μ„ ν†µν• Service μ±…μ„ λ¶„λ¦¬ λ° DTO μ΅°λ¦½"
   - "Feign ν¨ν„΄μ„ ν†µν• κΈ°μ  μμ΅΄μ„± λ¶„λ¦¬"
     
   (μ΄λ ¥μ„μ— λ¦¬ν©ν„°λ§μ„ λ„£λ” κ±΄ μ¶”μ²ν•μ§€ μ•μ§€λ§, κΈ°μ μ μΈ λ‚΄μ©μ΄ λ¶€μ΅±ν•λ©΄ μ•„λμ™€ κ°™μ΄ κµ¬μ²΄μ μΌλ΅ μ–΄λ–»κ² λ¦¬ν©ν„°λ§μ„ ν–λ”μ§€ μ μ–΄μ£Όμ„Έμ”.)
---

## 7.7 ν•µμ‹¬ λ©”μ‹μ§€

> **"κ²°κµ­ μ¤‘μ”ν• κ±΄ 'κµ¬ν„ κΈ°μ 'λ³΄λ‹¤ 'μ–΄λ–¤ λ¬Έμ λ¥Ό ν’€ κ²ƒμΈκ°€'λ¥Ό μ •μν•λ” νμ΄λ‹¤"**

### μ¤λ λ°°μ΄ κ²ƒ

1. β… **Serviceλ” λΉ„μ¦λ‹μ¤ λ΅μ§λ§ λ‹΄λ‹Ήν•κ³  κΈ°μ μ— μμ΅΄ν•μ§€ μ•μ•„μ•Ό ν•λ‹¤**
2. β… Repository μΈν„°νμ΄μ¤ν™”λ΅ κΈ°μ  μ¤νƒμ„ μ μ—°ν•κ² κµμ²΄ν•  μ μλ‹¤
3. β… Orchestrator ν¨ν„΄μΌλ΅ Serviceλ¥Ό μ–‡κ² μ μ§€ν•κ³  μ±…μ„μ„ λ¶„λ¦¬ν•λ‹¤
4. β… Serviceλ” λΉ„μ¦λ‹μ¤ λ΅μ§, Orchestratorλ” DTO μ΅°λ¦½λ§ λ‹΄λ‹Ήν•λ‹¤
5. β… μ™Έλ¶€ λ¨λ“ νΈμ¶μ€ μΈν„°νμ΄μ¤ + Feign ν¨ν„΄μ„ μ‚¬μ©ν•μ—¬ κΈ°μ  μμ΅΄μ„±μ„ λ¶„λ¦¬ν•λ‹¤
6. β… Entityμ™€ λ„λ©”μΈ λ¨λΈμ„ λ¶„λ¦¬ν•μ—¬ λ„λ©”μΈ λ¨λΈμ΄ κΈ°μ μ— λ…λ¦½μ μ΄κ² ν•λ‹¤
7. β… API μΈν„°νμ΄μ¤λ΅ API μ¤ν™μ„ λ…ν™•ν•κ² μ •μν•κ³  λ‹¤λ¥Έ μ„λΉ„μ¤μ™€ κ³µμ ν•  μ μλ‹¤

---

## κ°μ‚¬ν•©λ‹λ‹¤!

μ§λ¬Έμ΄ μμΌμ‹λ©΄ μ–Έμ λ“ μ§€ λ¬Όμ–΄λ³΄μ„Έμ”! π
